<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Lazy Loading with IntersectionObserver</title>

    <style>
        body {
            font-family: system-ui, sans-serif;
            background: #fafafa;
            padding: 24px;
        }

        .item {
            margin-bottom: 60px;
        }

        .item h3 {
            margin-bottom: 8px;
            font-weight: 500;
        }

        img {
            width: 100%;
            max-width: 420px;
            border-radius: 4px;
            background: #e0e0e0;
            display: block;
        }
    </style>
</head>

<body>
    <h1>Lazy Loading Demo</h1>

    <div id="list"></div>

    <script>
        const list = document.getElementById("list");

        for (let i = 1; i <= 15; i++) {
            const item = document.createElement("div");
            item.className = "item";

            const heading = document.createElement("h3");
            heading.textContent = `Image ${i}`;

            const image = document.createElement("img");
            image.src = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMSIgaGVpZ2h0PSIxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg==";

            image.dataset.src = `https://picsum.photos/seed/${i}/420/260`;
            image.classList.add("lazy");

            item.appendChild(heading);
            item.appendChild(image);

            list.appendChild(item);
        }


        const lazyItems = document.querySelectorAll(".lazy");

        const io = new IntersectionObserver(
            (entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;

                        // observer.unobserve(img);
                    }
                });
            },
            {
                rootMargin: "120px",
                threshold: 0.15
            }
        );

        lazyItems.forEach(img => io.observe(img));
    </script>
</body>

</html>